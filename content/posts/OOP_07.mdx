---
title: CodeSpitz78 5/ OOADì™€ í…ŒíŠ¸ë¦¬ìŠ¤ (2)
date: '2018-10-09'
description: "\U0001F315\U0001F311\U0001F311 > \U0001F525 ì½”ë“œìŠ¤í”¼ì¸  ìˆ˜ì—…ì„ ìˆ˜ê°•í•˜ë©´ì„œ ë³µìŠµí•œ ë‚´ìš©ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. > ì•„ì§ ì •ë¦¬ì¤‘.. --- 1. Stage Stage í´ë˜ìŠ¤ëŠ” ë­˜ í•„ìš”ë¡œ í• ê¹Œ?  1. íŒ   ë§ˆì§€ë§‰ íŒì´ ëª‡ íŒì¼ê¹Œ? = ëª‡ íŒê¹Œì§€ ìˆì„ê¹Œ? 2. ì†ë„   íŒë§ˆë‹¤ ì†ë„ê°€ ì¦ê°€í•œë‹¤.   -..."
author: Joy Kim
tags:
  - javaScript
  - OOP
categories:
  - 01_Web
  - zz. Workshop
enableComment: true
thumbnail: /images/2018/37/thumb_default.jpg
---

ğŸŒ•ğŸŒ‘ğŸŒ‘

> ğŸ”¥ ì½”ë“œìŠ¤í”¼ì¸  ìˆ˜ì—…ì„ ìˆ˜ê°•í•˜ë©´ì„œ ë³µìŠµí•œ ë‚´ìš©ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. ì•„ì§ ì •ë¦¬ì¤‘..

---


## 1. Stage ### Stage í´ë˜ìŠ¤ëŠ” ë­˜ í•„ìš”ë¡œ í• ê¹Œ? 1. íŒ ë§ˆì§€ë§‰ íŒì´ ëª‡ íŒì¼ê¹Œ? = ëª‡ íŒê¹Œì§€ ìˆì„ê¹Œ? 2.
ì†ë„ ** íŒë§ˆë‹¤ ì†ë„ê°€ ì¦ê°€í•œë‹¤.** - ìµœì†Œ ì†ë„ - ìµœëŒ€ ì†ë„ ** ì†ë„ëŠ” ì–´ë–¤ ê°ì²´ê°€ ê°€ì ¸ê°€ì•¼í• ê¹Œ?** -
Gameë³´ë‹¤ëŠ” Stageê°€ ì í•©. - ìº¡ìŠí™”ì™€ ì€ë‹‰í™”ì˜ ì†ì„±ì„ ì´ìš©í•˜ì—¬, ì†ë„ì˜ ì²˜ë¦¬ëŠ” stageë‚´ì—ì„œë§Œ ì²˜ë¦¬í•˜ê²Œ
í•œ í›„, ì™¸ë¶€ì—ì„œëŠ” ìµœì¢… ì†ë„ë§Œ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•œë‹¤. (getter) - ì´ˆê¸° ì†ë„ - ìê¸°ì˜ ë³€í™”ë¥¼ listenerí•œí…Œ
í†µë³´í•˜ëŠ” ê²ƒìœ¼ë¡œ ì²˜ë¦¬ë§Œ í•˜ê³  - listnerì˜ í˜•íƒœë¥¼ ì§ì ‘ ì•Œ í•„ìš”ëŠ” ì—†ê²Œ í•œë‹¤.

```js
// Object.assign ì“°ê¸° ë²ˆê±°ë¡œì›Œì„œ í•¨ìˆ˜ ë§Œë“¤ê¸”
const prop = (target, v) => Object.assign(target, v);
```

```js
const Stage = class {
  constructor(last, min, max, listener) {
    // lastëŠ” ë§ˆì§€ë§‰ íŒ
    // min,maxëŠ” ì†ë„
    // listener: ë‹¤ë¥¸ ê°ì²´ì™€ ê´€ê³„ë¥¼ ë§ºì§€ ì•Šê²Œ í•´ì£¼ëŠ” ì—­í• 
    // ê²Œì„ íŒ¨ë„ë“¤ì˜ ìŠ¤í…Œì´ì§€ ê·¸ë˜í”½ì´ ê°±ì‹ ì„ ìœ„í•´ì„œ listenerë¥¼ ë‹¬ì•„ì¤Œ.
    prop(this, { last, min, max, listener });
  }
  clear() {
    //ì´ˆê¸°í™”
    this.curr = 0; // í˜„ì¬ ìŠ¤í…Œì´ì§€ ë„˜ë²„
    this.next();
  }
  next() {
    // ì†ë„ ë¹„ìœ¨ = í˜„ì¬íŒ - 1 / ë§ˆì§€ë§‰ íŒ - 1
    // ë¸”ëŸ­ ë‚´ë ¤ì˜¬ ë•Œ ë”œë ˆì´ ì†ë„ = (this.max - this.min) * (1 - rate);
    // => ì ì  ì‘ì•„ì§„ë‹¤. => ìµœì¢… ì†ë„ëŠ” ë¹¨ë¼ì§
    if (this.curr++ < Stage.last) {
      const rate = (this.curr - 1) / (this.last - 1);
      this.speed = this.min + (this.max - this.min) * (1 - rate);
      this.listener();
    }
  }
};
```

---


## 2. Score

```js
const Score = class {
  constructor(listener){
    prop(this, {listener});
    // ìŠ¤ì½”ì–´ì˜ ê·¸ë˜í”½ì„ ê°±ì‹ ì‹œí‚¤ê¸° ìœ„í•´ì„œ í†µë³´ìš©ìœ¼ë¡œ listener ì¶”ê°€
  }
  clear(){
    this.curr = 0;
    this.total = 0;
  }
  add(line, stage){
    // lineì´ ì§€ì›Œì§€ëŠ” ê°¯ìˆ˜ë¥¼ í¬ì¸íŠ¸ ì¦ê°€ìœ¨
    // stage ë§ˆë‹¤ lineí•˜ë‚˜ ì§€ìš¸ë•Œë§ˆë‹¤ ì ìˆ˜ê°€ ë‹¤ë¦„
    const score = ???;
    this.curr += score; // í˜„ì¬ ì ìˆ˜ê°’ì—ë„ ë°˜ì˜
    this.total += score; // ì „ì²´ ì ìˆ˜ê°’ì—ë„ ë°˜ì˜
    this.listener();
  }
}
```

---

---

### cf\_\_1 ì—­í• , ì±…ì„, í˜‘ë ¥

í”„ë¡œê·¸ë˜ë°ì˜ ì‹¤ì²´ëŠ” **ìˆ˜í–‰í•´ì•¼í•˜ëŠ” jobì´ ëˆ„êµ¬ì˜ ì—­í• ê³¼ ì±…ì„ìœ¼ë¡œ ë„˜ì–´ê°€ì•¼í•˜ëŠ”ì§€ë¥¼ ì˜ì‚¬ê²°ì •í•˜ëŠ”
í–‰ìœ„.**

#### ğŸ¡ ê°ì²´ì§€í–¥

ê°ì²´ì§€í–¥ì—ì„œëŠ” **ì»¨í…ìŠ¤íŠ¸**ë¼ëŠ” ë°©ë²•ì´ ìˆë‹¤. ì¸ìŠ¤í„´ìŠ¤ë³„ë¡œ ì»¨í…ìŠ¤íŠ¸ë¼ëŠ” ìœ ì§€í•œë‹¤. (ì»¨í…ìŠ¤íŠ¸:
ì¸ìŠ¤í„´ìŠ¤ë§ˆë‹¤ ê³ ìœ í•˜ê²Œ ë¶€ì—¬ë˜ì–´ ìˆëŠ” ë©”ëª¨ë¦¬).

**í•¨ìˆ˜ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ë°©ë²• 2ê°€ì§€. **

1. ë‚´ê°€ ì¸ìë¡œ ê°’ì„ ê°€ì ¸ì˜¬ì§€,
2. ì»¨í…ìŠ¤íŠ¸ë¡œ ê°€ì ¸ì˜¬ì§€.

---

#### ğŸ¢ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ê³¼ ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì˜ ì°¨ì´ì .

- í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì—ì„œëŠ” **ììœ ë³€ìˆ˜ë¥¼ í†µí•´ì„œ í•¨ìˆ˜ë¥¼ ìœ ì§€í•œë‹¤.**
- ììœ ë³€ìˆ˜ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒˆë¡œìš´ í•¨ìˆ˜ ìƒì„±ì´ í•„ìš”í•˜ë‹¤. (í´ë¡œì €)
- why? í•¨ìˆ˜ê°€ íƒœì–´ë‚ ë•Œ ë§ˆë‹¤ ììœ ë³€ìˆ˜ë¡œ ì¸ì§€í•˜ê¸° ë•Œë¬¸ì—.

---

#### ğŸ­ ê°ì²´ì§€í–¥ì„ í†µí•´ì„œ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” í–‰ìœ„ë¥¼ í•¨ìˆ˜í˜•ìœ¼ë¡œ ë°”ê¾¸ë©´?

- í•„ìš”í•œ ììœ ë³€ìˆ˜ë¥¼ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ë¦¬í„´í•˜ëŠ” í–‰ìœ„ì™€ ê°™ë‹¤.
- ê·¸ í•¨ìˆ˜ê°€ ì»¨í…ìŠ¤íŠ¸ ëŒ€ì‹  **ììœ ë³€ìˆ˜ë¡œ í•´ë‹¹ ìƒíƒœë¥¼ ê¸°ì–µí•˜ê³  ìˆì„í…Œë‹ˆê¹Œ.**
- <span class="mint">**ê°ì²´ì§€í–¥**</span>ì—ì„œ ì¸ìŠ¤í„´ìŠ¤ì˜ ìˆ˜ë§Œí¼ =>  í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ëŠ” ê±¸ë¡œ <span class="orange">**í•¨ìˆ˜ì§€í–¥**</span>ìœ¼ë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤.

```js
const Score = class {
  constructor(listener){
    prop(this, {listener});
    // ìŠ¤ì½”ì–´ì˜ ê·¸ë˜í”½ì„ ê°±ì‹ ì‹œí‚¤ê¸° ìœ„í•´ì„œ í†µë³´ìš©ìœ¼ë¡œ listener ì¶”ê°€
  }
  clear(){
    this.curr = 0;
    this.total = 0;
  }
  add(line, stage){
    // score ê³„ì‚°ì„ ìœ„í•´ì„œëŠ” stageë§Œ ì•Œ ìˆ˜ ìˆëŠ” ê°’ì„ ì´ìš©í•´ì•¼í•˜ê¸° ë•Œë¬¸ì—
    // stage ë‚´ë¶€ì— scoreë¥¼ ê³„ì‚°í•˜ëŠ” ì±…ì„ì„ ì£¼ê³ ,(ìœ„ì„)
    // Scoreì˜ addí•¨ìˆ˜ì—ì„œëŠ” scoreë¥¼ í˜¸ì¶œ, ì ìˆ˜ë§Œ ë”í•˜ëŠ” ì±…ì„ë§Œ ì¤€ë‹¤.(í˜‘ë ¥)
    const score = stage.score(line);
    this.curr += score; // í˜„ì¬ ì ìˆ˜ê°’ì—ë„ ë°˜ì˜
    this.total += score; // ì „ì²´ ì ìˆ˜ê°’ì—ë„ ë°˜ì˜
    this.listener();
  }
}
const Stage = class {
  ...
  score(line) {
    return parseInt((this.curr * 5) * (2 ** line))
  }
}


```

---

#### ìŠ¤ì½”ì–´ì™€ ìŠ¤í…Œì´ì§€ ê°„ì˜ coupling ê´€ê³„

í˜„ì¬ëŠ” **ì•½í•œ ë°”ì¸ë”©.** add í•¨ìˆ˜ í˜¸ì¶œì‹œì—ë§Œ ì„ì‹œì ìœ¼ë¡œ ì™¸ë¶€ ì¸ìë¡œ ë“¤ì–´ì˜¤ê¸°ë•Œë¬¸ì—

But, í•˜ë‚˜ì˜ ê²Œì„ ì•ˆì—ì„œëŠ” ìŠ¤í…Œì´ì§€ì™€ ìŠ¤ì½”ì–´ë¥¼ ë™ì‹œì— ì†Œìœ í•˜ê³  ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.

- **ê²Œì„ì—ì„œì˜ ìŠ¤í…Œì´ì§€ ê´€ë¦¬ìì™€ ìŠ¤ì½”ì–´ ê´€ë¦¬ìëŠ” ê´€ê³„ê°€ í•­êµ¬ì .** ì¦‰, ê²Œì„ì´ ì§„í–‰ë˜ëŠ” ë™ì•ˆ. ì¦‰ ë§¤ë²ˆ
  ì¸ìë¡œ ë³´ë‚´ë©´ ì•ˆëœë‹¤.
- ë§¥ë½ìƒ ë§ì§€ ì•Šë‹¤ëŠ” ë§. stageë¥¼ addí•¨ìˆ˜ì˜ ì¸ìë¡œ ë³´ë‚¸ë‹¤ëŠ” ê²ƒì€ ìŠ¤ì½”ì–´ë¥¼ ë” í• ë•Œë§ˆë‹¤ ì„ì‹œì ìœ¼ë¡œ
  ë°”ì¸ë”©í•œë‹¤ëŠ” ê²ƒì¸ë° ì´ëŠ” ìœ„ì˜ í•­êµ¬ì ì¸ ê´€ê³„ì™€ ë§ì§€ ì•ŠìŒ. (ì½”ë“œì˜ ì˜ë¯¸ê°€ ë§ì§€ ì•ŠìŒ.)
- ë•Œë¬¸ì— addì˜ ì¸ìê°€ ì•„ë‹ˆë¼ ì»¨í…ìŠ¤íŠ¸ ë³€ìˆ˜ë¡œ ì˜®ê²¨ì¤˜ì•¼í•œë‹¤.

**ë„ë©”ì¸ì„ ë°”ë¼ë³´ê³  ì–´ë”” ìª½ì˜ ì—­í• ì´ ë§ëŠ”ì§€ í•­ìƒ ì˜ì‚¬ê²°ì •ì„ í•´ì•¼í•œë‹¤.**

```js
const Score = class {
  constructor(ğŸ‘‰stage, listener){
    prop(this, {stage, listener});
  }
  clear(){
    this.curr = 0;
    this.total = 0;
  }
  add(line){
    const score = ğŸ‘‰this.stage.score(line);
    this.curr += score; // í˜„ì¬ ì ìˆ˜ê°’ì—ë„ ë°˜ì˜
    this.total += score; // ì „ì²´ ì ìˆ˜ê°’ì—ë„ ë°˜ì˜
    this.listener();
  }
}
const Stage = class {
  ...
  score(line) {
    return parseInt((this.curr * 5) * (2 ** line))
  }
}
```

<img src="/images/2018/38/01.png" style={{width: '100%'}} />
scoreì™€ stageê°„ì˜ ì˜ì¡´ì„±ì´ ìƒê¹€

> ì½”ë“œëŠ” ì—¬ëŸ¬ë¶„ë“¤ì´ ëª¨êµ­ì–´ë¡œ ì“°ì§€ ì•Šê¸° ë•Œë¬¸ì— ë™ì‘ë§Œ í•˜ë©´ ë‹¤ ë˜‘ê°™ì€ ì½”ë“œë¡œ ë³´ì¸ë‹¤. ì½”ë“œë„ ì–¸ì–´ì´ê¸°
> ë•Œë¬¸ì— í•œêµ­ì–´ì˜ ë¯¸ë¬˜í•œ ëŠ¬ì•™ìŠ¤ë¥¼ ë‹¤ì–‘í•œ í˜•ì‚¬ì™€ ë™ì‚¬ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì²˜ëŸ¼, **ì½”ë“œë„ ë™ì‘í•´ë„ í‘œí˜„ë°©ë²•ì—
> ë”°ë¼ì„œ ëŠ¬ì•™ìŠ¤ë¥¼ ë‹¤ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.**

---


## 3. Block
#### í´ë˜ìŠ¤ì¼ê¹Œ ì¸ìŠ¤í„´ìŠ¤ì¼ê¹Œ.
- ì°ì–´ë‚¼ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. => í´ë˜ìŠ¤ 
- ë¶€ëª¨í´ë˜ìŠ¤ >> ìì‹í´ë˜ìŠ¤

#### ë¸”ëŸ­ ì •ì˜

- í…ŒíŠ¸ë¦¬ìŠ¤ ë¸”ëŸ­ì€ íšŒì „ì„ í•  ìˆ˜ ìˆë‹¤. **íšŒì „ì¶•, íšŒì „ì **ì„ ì •ì˜í•˜ì.
  <img src="/images/2018/38/02.png" style={{width: '120px', margin: '0'}} />
  ì„¸ë¡œì™€ ê°€ë¡œì˜ ëª¨ìŠµì„ ë³´ë©´ **2ì°¨ì› ë°°ì—´**ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ ë³´ì¸ë‹¤. (í–‰ê³¼ ì—´)

cf\_\_2 ì—°ì‚°ì€ ë°ì´í„°ë¡œ ë°”ê¿€ ìˆ˜ ìˆë‹¤. `ë°ì´í„° í•˜ë‚˜ë¡œ ì—°ì‚°í™” ì‹œí‚´` or `ë°ì´í„° 2ê°œë¡œ ì—°ì‚°ë¹„ìš©ì„ ë‚®ì¶¤.`

- ì˜ˆì „ì—ëŠ” ë¨¸ì‹ ì´ ë‚®ê³  ë©”ëª¨ë¦¬ê°€ ë‚®ì•˜ê¸° ë•Œë¬¸ì— ì—°ì‚°ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì›€ì§ì´ê³  ë©”ëª¨ë¦¬ ë¹„ìš©ì„ ë‚®ì¶”ëŠ” ë°©í–¥ìœ¼ë¡œ
  ê°”ìŒ.
- cpu ë¹„ìš©ì„ ì•„ë¼ê³ (ì—°ì‚°ë¹„ìš©ì„ ì¤„ì´ê³ ) ë©”ëª¨ë¦¬ ë¹„ìš©ì„ ì‚¬ìš©í•˜ëŠ” ë°©í–¥ì´ ìš”ì¦˜ ì¶”ì„¸

```js
// Block í´ë˜ìŠ¤ : ì¹´í…Œê³ ë¼ì´ì œì´ì…˜ í•˜ëŠ” ì¤‘..
// => ëª¨ë“  ìì‹ ë¸”ëŸ­ë“¤ì´ ê³µí†µìœ¼ë¡œ ê°€ì ¸ì•¼í•˜ëŠ” ì†ì„±ë“¤
const Block = class {
  constructor(color) {
    prop(this, {color, rotate:0};)
  }
  // rotate: CW, CCW (ì‹œê³„ë°©í–¥, ì‹œê³„ë°˜ëŒ€ë°©í–¥ ê°œë…)
  left() {
    if(--this.rotate < 0) this.rotate = 3;
  }
  right() {
    if(++this.rotate > 3) this.rotate = 0;
  }
  getBlock(){throw 'override!';}
}
const blocks = [class extends Block, ...]
```

<img src="/images/2018/38/02.png" style={{width: '120px', margin: '0'}} />
```js
class extends Block {
  constructor(){
    super('#f8cbad');
  }
  getBlock(){
    return this.rotate % 2 ?
      [[1], [1], [1], [1]] : 
      [[1,1,1,1]]
      // [[1], [1], [1], [1]] ì»¬ëŸ¼ì´ í•˜ë‚˜ë§Œ ìˆëŠ” rowê°€ 4ê°œì¸ ë°°ì—´ : |
      // [[1,1,1,1]] rowê°€ í•˜ë‚˜ë§Œ ìˆëŠ” ì»¬ëŸ¼ì´ 4ê°œì¸ ë°°ì—´: ----
  }
}
```

<img src="/images/2018/38/03.png" style={{width: '150px', margin: '0'}} />
```js
class extends Block {
  constructor(){
    super('#f8cbad');
  }
  getBlock(){
    switch(this.rotate){
      case 0: return [[0,1,0], [1,1,1]]
      case 1: return [[1,0], [1,1], [1,0]]
      case 2: return [[1,1,1], [0,1,0]]
      case 3: return [[0,1], [1,1], [0,1]]
    }
  }
}
```

### ì¶©ë¶„íˆ ì¶”ìƒí™”ê°€ ë˜ì—ˆì„ê¹Œ?

rotationì€ ë¶€ëª¨í´ë˜ìŠ¤ì¸ Blockì—ì„œ ê´€ë¦¬ ìì‹ì´ ë¶€ëª¨ì˜ ì†ì„±ì„ ê°–ëŠ” ê²ƒì€ **ì€ë‹‰ì„ ê¹¨ê³  ìˆëŠ” ê²ƒ**

- ë¶€ëª¨ ìì‹ê°„ì—ë„ ìº¡ìŠí™”ì™€ ì€ë‹‰í™”ê°€ ì„±ë¦½í•´ì•¼í•œë‹¤.
- `this.rotate`ë¡œ ì ‘ê·¼í•˜ê³  ìˆë‹¤.
- `this.rotate % 2` ë¶€ëª¨ì˜ rotate ì •ì˜ì— ìì‹ì´ ë§ì¶”ê³  ìˆë‹¤.
  > ì½”ë“œì˜ ì±…ì„, ì—­í• ì„ ì˜ì¸í™” ì‹œì¼œì„œ ìƒê°í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

getBlcok()ì„ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ **ë°°ì—´ì„ ë§¤ë²ˆ ìƒì„±í•˜ê³  ìˆë‹¤.**

- ì»¨í…ìŠ¤íŠ¸ ë°ì´í„°ê°€ ë˜ì–´ì•¼í•œë‹¤.

ë‹¤ì‹œ ê°œì„ 

```js
const Block = class {
  constructor(color, âœ¨âœ¨...blocks) {
    prop(this, {
      color,
      rotate:0,
      âœ¨âœ¨blocks,
      âœ¨âœ¨count: blocks.length - 1 // íšŒì „ ì¹´ìš´íŠ¸
    };)
  }
  left() {
    if(--this.rotate < 0) this.rotate = 3;
  }
  right() {
    if(++this.rotate > âœ¨âœ¨count) this.rotate = 0;
  }
  getBlock(){ âœ¨âœ¨
    // í´ë˜ìŠ¤ë¥¼ ë°˜í™˜
    return this.blocks[this.rotate];
  }
}
const blocks = [
  class extends Block {
    constructor(){
      super('#f8cbad',
        [[1], [1], [1], [1]],
        [[1,1,1,1]]
      );
    }
  }
]
```


## 4. Renderer ë Œë”ëŸ¬ëŠ” stage, score, blockì„ ëª°ë¼ë„, dataë§Œ ì•Œì•„ë„ ë˜ëŠ” êµ¬ì¡°
<img src="/images/2018/38/04.png" />

```js
const Renderer = class {
  constructor(col, row) {
    prop(this, { col, row, blocks: [] });
    while (row--) this.blocks.push([]);
  }
  clear() {
    throw 'override';
  }
  // ìì‹ì´ í´ë¦¬ì–´ í•´ì•¼í•œë‹¤.
  // ëŒ€ì²´ê°€ëŠ¥ì„±(ìƒì†ì„±)ê³¼ ë‚´ì ë™ì§ˆì„±(ë‹¤í˜•ì„±).
  // ìì‹ì„ ë‹¤ ë¶€ëª¨ë¡œ ë³´ê²Œ í•˜ê³  ì‹¶ë‹¤.
  // ì–´ë–¤ ìì‹ì´ ì™€ë„ clearë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
  // ë¶€ëª¨ì˜ clearë¥¼ í˜¸ì¶œí•´ë„ ë‚´ì ë™ì§ˆì„±ë•Œë¬¸ì— ìì‹ì˜ clearê°€ í˜¸ì¶œëœë‹¤.
  // ëª…ì‹œì ìœ¼ë¡œ clearë¼ëŠ” methodë¥¼ ë¶€ëª¨ì— í• ë‹¹í•´ì£¼ì§€ë§Œ, ìì‹ë“¤ì´ ë Œë”ë§ í•˜ëŠ” ë°©ì‹ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ì‹¤ì œ clearëŠ” ë‹¤í˜•ì„±ì— ì˜í•´ì„œ ìì‹ë“¤ì˜ clear ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤. == ë¬´ì˜ë¯¸í•œ ì½”ë“œê°€ ì•„ë‹ˆë‹¤.
  render(data) {
    if (!(data instanceof Data)) throw 'invalid data';
    // í”„ë¡œí† ì½œ í™•ì¸ë§Œ í•´ì¤€ë‹¤.
    this._render(data);
    // ë‚´ì ë™ì§ˆì„±(ë‹¤í˜•ì„±)ì— ì˜í•´ì„œ ìì‹ì˜ _renderê°€ í˜¸ì¶œëœë‹¤.
    // ë””ìì¸ íŒ¨í„´ ì¤‘: í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ (ê°ì²´ì§€í–¥ ì–¸ì–´ê°€ ë‚´ì ë™ì§ˆì„±ì„ ë³´ì¥í•´ì£¼ì–´ì•¼í•œë‹¤)
    // í…œí”Œë¦¿ ë©”ì„œë“œë¥¼ ì‚¬ì˜¹í•˜ëŠ” ì´ìœ 
    // ë¶€ëª¨ìª½ì— ìˆëŠ” ë©”ì„œë“œê°€ ë§ì€ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ê³  ì‹¤ì œ í•  ì¼ì„ í›„í‚¹í•˜ê³  ìˆëŠ” ìì‹í´ë˜ìŠ¤ì—ê²Œ ìœ„ì„í•˜ê¸° ìœ„í•´
  }
  _render(data) {
    throw 'override!';
  }
};
```

> **Template Method Pattern** ì–´ë–¤ ì‘ì—… ì•Œê³ ë¦¬ì¦˜ì˜ ê³¨ê²©ì„ ì •ì˜í•œë‹¤. ì¼ë¶€ ë‹¨ê³„ëŠ” ì„œë¸Œ í´ë˜ìŠ¤ì—ì„œ
> êµ¬í˜„í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤. í…œí”Œë¦¿ ë©”ì„œë“œë¥¼ ì´ìš©í•˜ë©´ ì•Œê³ ë¦¬ì¦˜ì˜ êµ¬ì¡°ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œ íŠ¹ì • ë‹¨ê³„ë§Œ
> ì„œë¸Œ í´ë˜ìŠ¤ì—ì„œ ìƒˆë¡œ ì •ì˜í•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.


## 4-0. Data(protocol)

```js
// Arrayë¥¼ ìƒì† ë°›ëŠ” ì´ìœ ëŠ” í˜•ì„ í™•ì¸í•˜ê¸° ìœ„í•´ ê°•ì œë¡œ ë§Œë“¦.
// ë§ˆí¬ì—… í´ë˜ìŠ¤
// Arrayê°ì²´ë¥¼ ë² ì´ìŠ¤ë¡œ í•˜ëŠ” ê°ì²´ê°€ ë§Œë“¤ì–´ì§„ë‹¤.
const Data = class extends Array {
  constructor(row, col) {
    prop(this, { row, col });
  }
};
```

> es6ëŠ” í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ thisë¥¼ ë°”ê¿” ì¤„ ìˆ˜ ìˆë‹¤.


## 4-1. Table Renderer

```js
// utility
const el = el => document.createElement(el);
const back = (s: pixel, v: color) => s.backgroundColor = v;
// ë°°ê²½ ìƒ‰ ë³€ê²½ìœ¼ë¡œ ì›€ì§ì„ì„ í‘œí˜„í•œë‹¤.
```

```js
const TableRenderer = class extends Renderer {
  // base: í…Œì´ë¸” element
  // back: background ì¹¼ë¼
  constructor(base, back, col, row){
    super(col, row);
    this.back = back;
    white(row--){
      const tr = base.appendChild(el('tr')), curr = []; // rowë§Œí¼ trì„ ë§Œë“¤ì–´ì„œ ë„£ê¸°.
      this.blocks.push(curr); // ë¹ˆ ë¸”ëŸ­ ë°°ì—´ì„ blocksì— ë„£ì–´ì¤€ë‹¤. this.blocksëŠ” Rendererì˜ blocks
      let i = col;
      while(i--) curr.push(tr.appendChild('td').style);
      // ìŠ¤íƒ€ì¼ ê°ì²´ë§Œ ë„£ëŠ”ë‹¤.
    }
    this.clear();
  }
  clear(){
    this.blocks.forEach(
      curr => curr.forEach(s => back(s, this.back))
    )
    // backí•¨ìˆ˜ëŠ” utilityì˜ back
    // backí•¨ìˆ˜ì— í˜„ì¬ back ì¹¼ë¼ë¥¼ ì „ë¶€ í• ë‹¹í•œë‹¤.
  }
  _render(v: Data){
    this.blocks.forEach(
      (curr, row) => curr.forEach((s, col) => back(s, v[row][col]))
    )
  }
}
```

> **ë³€ìˆ˜ ì‚¬ìš©ì‹œ í•œ ë²ˆ ë°–ì— ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë° ë³€ìˆ˜ë¡œ ì¡ëŠ” ê²ƒì€ ì‚¬ì‹¤ì€ ì¤‘ë³µ**

---

> <span class="mint">**forì™€ forEach ì¤‘ ì–´ë–¤ê±¸ ì‚¬ìš©í• ê¹Œ?**</span>
> ì–¸ì–´ìŠ¤íŒ©ì—ì„œ ì •ì˜ë˜ì–´ìˆëŠ” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì. **forEach** ì„±ëŠ¥ë¬¸ì œëŠ” ìš°ì„  ê³ ë ¤í•˜ì§€ ë§ì.


## 4-2. Canvas Renderer

```js
const CanvasRenderer = class extends Renderer {
  constructor(base, back, col, row) {
    suepr(col, row);
    prop(this, {
      width: (base.width = parseInt(base.style.width)),
      height: (base.height = parseInt(base.style.height)),
      cellSize: [base.width / col, base.height / row],
      ctx: base.getContext('2d'),
    });
  }
  _render(v) {
    const {
      ctx,
      cellSize: [w, h],
    } = this;
    ctx.clearRect(0, 0, this.width, this.height);
    let i = this.row;
    while (i--) {
      let j = this.col;
      while (j--) {
        ctx.fillStyle = v[i][j];
        ctx.fillRect(j * w, j * h, w, h);
      }
    }
  }
};
```

---

**ì°¸ê³ ìë£Œ** https://www.bsidesoft.com/?p=2827 https://github.com/abhbtbb/tetris1
